{
    "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PTERODACTYL PANEL - PTERODACTYL.IO",
    "meta": {
        "version": "PTDL_v1",
        "update_url": null
    },
    "exported_at": "2021-05-27T18:47:03+02:00",
    "name": "Suicide Survival",
    "author": "kevin@kevinswebsite.nl",
    "description": "A game about shrubbery",
    "features": null,
    "images": [
        "quay.io\/parkervcp\/pterodactyl-images:debian_wine-5"
    ],
    "file_denylist": [],
    "startup": "$HOME\/StartSteam.sh;\r\nwine \/home\/container\/suicidesurvival\/SrcdsConRedirect.exe -game suicidesurvival -console -ip {{IP}} -port {{SERVER_PORT}} +maxplayers {{MAX_PLAYERS}} +map {{MAP}}",
    "config": {
        "files": "{}",
        "startup": "{\r\n    \"done\": \"Connection to Steam servers successful\",\r\n    \"userInteraction\": []\r\n}",
        "logs": "{}",
        "stop": "^C"
    },
    "scripts": {
        "installation": {
            "script": "#!\/bin\/bash\r\n# Installation Script\r\n#\r\n## Define variables\r\ngame=\"http:\/\/www.suicide-survival.com\/SuicideSurvival_Release_1_1.rar\"\r\nredirectmod=\"https:\/\/forums.alliedmods.net\/attachment.php?attachmentid=157468&d=1474482488\"\r\nsteam=\"https:\/\/cdn.cloudflare.steamstatic.com\/client\/installer\/SteamSetup.exe\"\r\nmissingfiles=\"https:\/\/raw.githubusercontent.com\/parkervcp\/eggs\/master\/steamcmd_servers\/suicidesurvival\/missing_scripts.zip\"\r\nmissingfilessecondary=\"https:\/\/github.com\/parkervcp\/eggs\/raw\/a1e8d6bf624810a017d52ddab62a6182d6d61494\/steamcmd_servers\/suicidesurvival\/missing_scripts.zip\"\r\n\r\nexport HOME=\/mnt\/server\r\n\r\n## Install dependencies\r\ndpkg --add-architecture i386\r\napt update\r\napt -y --no-install-recommends install curl unar unzip libstdc++6 lib32gcc1 ca-certificates libsdl2-2.0-0:i386 cabextract\r\napt install -y --install-recommends wine wine64 xvfb\r\n\r\n## download and install steamcmd\r\nmkdir \/tmp\r\ncd \/tmp\r\nmkdir -p \/mnt\/server\/steamcmd\r\ncurl -sSL -o steamcmd.tar.gz https:\/\/steamcdn-a.akamaihd.net\/client\/installer\/steamcmd_linux.tar.gz\r\ntar -xzvf steamcmd.tar.gz -C \/mnt\/server\/steamcmd\r\ncd \/mnt\/server\/steamcmd\r\n\r\nchown -R root:root \/mnt\r\n\r\necho \"Installing Source Dedicated Server\"\r\n## Install game using steamcmd, max 5 attempts, steamcmd doesn't always work for some reason.\r\nmkdir $HOME\/suicidesurvival\r\nCOUNT=0\r\nATTEMPTS=5\r\nuntil [[ -d $HOME\/suicidesurvival\/hl2 ]] || [[ $COUNT -eq $ATTEMPTS ]]; do\r\n  echo -e \"Attempting to download with SteamCMD: $(( COUNT++ ))... \\c\"\r\n  .\/steamcmd.sh +login anonymous +@sSteamCmdForcePlatformType windows +force_install_dir $HOME\/suicidesurvival +app_update ${APPID} ${EXTRA_FLAGS} validate +quit\r\n  sleep 1\r\ndone\r\n[[ $COUNT -eq $ATTEMPTS ]] && echo \"SteamCMD failed\" && (exit 1)\r\n\r\n## set up 32 bit libraries\r\nmkdir -p $HOME\/.steam\/sdk32\r\ncp -v linux32\/steamclient.so ..\/.steam\/sdk32\/steamclient.so\r\n\r\n## set up 64 bit libraries\r\nmkdir -p $HOME\/.steam\/sdk64\r\ncp -v linux64\/steamclient.so ..\/.steam\/sdk64\/steamclient.so\r\n\r\n## Install game files\r\nif [ ! -d $HOME\/suicidesurvival\/suicidesurvival ]\r\nthen\r\n    curl $game -o \/tmp\/suicidesurvival.rar\r\n    unar \/tmp\/suicidesurvival.rar -o $HOME\/suicidesurvival\r\n    mv $HOME\/suicidesurvival\/suicidesurvival\/SuicideSurvival $HOME\/suicidesurvival\/SuicideSurvivalTemp\r\n    rm -rf $HOME\/suicidesurvival\/suicidesurvival\/\r\n    mv $HOME\/suicidesurvival\/SuicideSurvivalTemp $HOME\/suicidesurvival\/suicidesurvival\r\n    \r\n    curl $redirectmod -o \/tmp\/redirect.zip\r\n    unzip \/tmp\/redirect.zip -d $HOME\/suicidesurvival\/\r\nfi\r\n\r\n## Install missing script files\r\necho \"Installing missing script files\"\r\nif [ ! -f \/tmp\/missing_files.zip ]\r\nthen\r\n    if curl --output \/dev\/null --silent --head --fail \"$missingfiles\"\r\n    then\r\n        echo \"File exists in the main repository: $missingfiles\"\r\n        curl $missingfiles -sSL -o \/tmp\/missing_files.zip\r\n    else\r\n        echo \"File does not exists in the main repository: $missingfiles\"\r\n        echo \"Trying a backup url\"\r\n        if curl --output \/dev\/null --silent --head --fail \"$missingfilessecondary\"\r\n        then\r\n            echo \"File exists in the backup repository: $missingfilessecondary\"\r\n            curl $missingfilessecondary -sSL -o \/tmp\/missing_files.zip\r\n        else\r\n            echo \"Cannot download missing script files, the server might display errors when starting.\"\r\n        fi\r\n    fi\r\nfi\r\nif [ -f \/tmp\/missing_files.zip ]\r\nthen\r\n    echo \"Unzipping missing files\"\r\n    rm $HOME\/suicidesurvival\/suicidesurvival\/scripts\/game_sounds_weapons.txt\r\n    unzip \/tmp\/missing_files.zip -d $HOME\/suicidesurvival\/suicidesurvival\/scripts\/\r\nelse\r\n    echo \"Cannot unzip missing script files, the file was never downloaded\"\r\nfi\r\n\r\necho \"Creating Steam start script\"\r\ntouch $HOME\/StartSteam.sh\r\nchmod +x $HOME\/StartSteam.sh\r\necho '#!\/bin\/bash' >> $HOME\/StartSteam.sh\r\necho 'rm $HOME\/SteamClientLog.out' >> $HOME\/StartSteam.sh\r\necho 'nohup wine \"$HOME\/.wine\/drive_c\/Program Files (x86)\/Steam\/steam.exe\" \"-silent\" > SteamClientLog.out &' >> $HOME\/StartSteam.sh\r\necho 'echo \"Starting Steam client...\"' >> $HOME\/StartSteam.sh\r\necho 'sleep 10' >> $HOME\/StartSteam.sh\r\n\r\n## Create default config\r\necho -e \"Creating default configuration file\"\r\ntouch $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'hostname \"Pterodactyl Server\"' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'rcon_password \"ChangeThis\"' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho '' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho '\/\/ Gameplay' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'mp_flashlight 0' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'mp_fraglimit 50' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'mp_timelimit 30' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'mp_falldamage 30' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'mp_teamplay 1' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'mp_teams_unbalance_limit 1' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'mp_autoteambalance 1' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'mp_allowspectators 1' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho '' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho '\/\/ Server Cvars' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_lan 0' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_region 1' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_downloadurl \"http:\/\/suicide-survival.com\/sv_download\"' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_allowupload 0' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_allowdownload 1' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_voiceenable 1' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_alltalk 1' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_maxrate 0' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'net_maxfilesize 99999' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_minrate 100000' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_minupdaterate 34' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_maxupdaterate 67' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho '' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho '\/\/ everyone talks to everyone else' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_alltalk on' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho '' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho '\/\/ show server in server list' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'sv_master_legacy_mode 0' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho '' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'fps_max 0' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\necho 'heartbeat' >> $HOME\/suicidesurvival\/suicidesurvival\/cfg\/Server.cfg\r\n\r\n## Install WineTricks\r\nexport DISPLAY=:0.0\r\nexport WINEPREFIX=$HOME\/.wine\r\nrm -r $HOME\/.wine\r\nrm -r $HOME\/.cache\r\nmkdir -p $HOME\/.wine\r\nmkdir \/tmp\/winetricks\r\ncurl https:\/\/raw.githubusercontent.com\/Winetricks\/winetricks\/master\/src\/winetricks -o \/tmp\/winetricks\/winetricks\r\nchmod +x \/tmp\/winetricks\/winetricks\r\nXvfb :0 -screen 0 1024x768x16 &\r\nenv WINEDLLOVERRIDES=\"mscoree=d;mshtml=d\" wineboot --init --force \/nogui\r\nenv \/tmp\/winetricks\/winetricks -q vcrun2017  \r\nenv \/tmp\/winetricks\/winetricks -q vcrun2013 \r\nenv \/tmp\/winetricks\/winetricks -q sound=disabled  \r\nenv \/tmp\/winetricks\/winetricks -q corefonts\r\nenv \/tmp\/winetricks\/winetricks -q --force dotnet48\r\n\r\n# Install Steam\r\necho \"Downloading SteamSetup.exe\"\r\ncurl $steam -o \/tmp\/SteamSetup.exe\r\nnohup wine \/tmp\/SteamSetup.exe \/S &\r\necho \"Sleeping 240 seconds to allow steam to install in the background \"\r\nsleep 240\r\n\r\nrm -rf \/tmp\r\necho \"Done!\"",
            "container": "debian:buster-slim",
            "entrypoint": "bash"
        }
    },
    "variables": [
        {
            "name": "APP ID",
            "description": "The ID corresponding to the game to download.",
            "env_variable": "APPID",
            "default_value": "310",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|numeric|digits_between:1,6"
        },
        {
            "name": "Maximum Players",
            "description": "",
            "env_variable": "MAX_PLAYERS",
            "default_value": "12",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|numeric|digits_between:1,3"
        },
        {
            "name": "WINEARCH",
            "description": "WINEARCH. win32 or win64",
            "env_variable": "WINEARCH",
            "default_value": "win64",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|string|in:win32,win64"
        },
        {
            "name": "WINEPREFIX",
            "description": "WINEPREFIX",
            "env_variable": "WINEPREFIX",
            "default_value": "\/home\/container\/.wine",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|string|max:64"
        },
        {
            "name": "WINEDEBUG",
            "description": "WINEDEBUG: Debug Level of wine",
            "env_variable": "WINEDEBUG",
            "default_value": "-all",
            "user_viewable": false,
            "user_editable": false,
            "rules": "nullable|string|max:20"
        },
        {
            "name": "Map",
            "description": "",
            "env_variable": "MAP",
            "default_value": "ss_garden2",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|max:50"
        },
        {
            "name": "Ip",
            "description": "the IP address to use when starting wine",
            "env_variable": "IP",
            "default_value": "0.0.0.0",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|max:20"
        }
    ]
}
